Search.setIndex({"docnames": ["README", "bibliography", "intro", "intro/accuracy_explainability", "intro/cbm", "intro/metrics", "intro/teaser", "nir/cmr", "nir/paradigm"], "filenames": ["README.rst", "bibliography.md", "intro.md", "intro/accuracy_explainability.ipynb", "intro/cbm.ipynb", "intro/metrics.ipynb", "intro/teaser.ipynb", "nir/cmr.ipynb", "nir/paradigm.ipynb"], "titles": ["Concept-based Interpretable Deep Learning in Python", "Bibliography", "Concept-based Interpretable Deep Learning in Python", "<span class=\"section-number\">4. </span>The accuracy-explainability trade-off", "<span class=\"section-number\">2. </span>Concept Bottleneck Models", "<span class=\"section-number\">3. </span>Quantitative metrics", "<span class=\"section-number\">1. </span>The tale of the deep learning model that failed my driving exam", "<span class=\"section-number\">6. </span>Concept-based Memory Reasoning", "<span class=\"section-number\">5. </span>The \u201cNeural Generation - Symbolic Execution\u201d paradigm"], "terms": {"thi": [0, 2, 3, 4, 5], "book": [0, 2], "demonstr": [0, 2], "how": [0, 2, 3, 4, 5], "build": [0, 2], "model": [0, 1, 2, 3], "us": [0, 3, 4, 5, 6], "pyc": [0, 4], "librari": [0, 4], "creat": 0, "local": 0, "repositori": 0, "clone": 0, "project": 0, "from": [0, 3, 4, 5, 6], "github": 0, "The": [0, 2, 4, 5], "main": 0, "branch": 0, "stabl": 0, "do": [0, 3, 5, 6], "write": 0, "test": [0, 4, 5, 6], "your": [0, 6], "open": 0, "dev": 0, "updat": 0, "notebook": 0, "respect": 0, "part": [0, 4], "folder": 0, "e": [0, 5], "g": [0, 4, 5], "intro": 0, "add": 0, "_toc": 0, "yml": 0, "file": 0, "section": 0, "submit": 0, "pull": [0, 6], "request": 0, "ask": [0, 5, 6], "review": 0, "onc": 0, "approv": [0, 4], "merg": 0, "eventu": 0, "knt": [1, 4], "20": [1, 4], "pang": 1, "wei": 1, "koh": 1, "thao": 1, "nguyen": 1, "yew": 1, "siang": 1, "tang": 1, "stephen": 1, "mussmann": 1, "emma": 1, "pierson": 1, "been": [1, 5, 6], "kim": 1, "perci": 1, "liang": 1, "concept": 1, "bottleneck": [1, 2, 3, 5], "In": [1, 3, 4, 5], "intern": 1, "confer": 1, "machin": 1, "learn": [1, 3, 4, 5], "5338": 1, "5348": 1, "pmlr": 1, "2020": 1, "tale": [2, 4, 5], "fail": [2, 5], "my": [2, 5], "drive": [2, 3, 4, 5], "exam": [2, 5], "quantit": 2, "metric": 2, "accuraci": 2, "explain": [2, 4, 6], "trade": 2, "off": 2, "gener": [2, 5], "symbol": 2, "execut": 2, "paradigm": 2, "memori": 2, "bibliographi": 2, "previou": 3, "chapter": [3, 4, 5], "we": [3, 4, 5], "explor": 3, "cbm": [3, 4, 5], "can": [3, 4, 5, 6], "effect": 3, "answer": [3, 4, 5, 6], "evalu": [3, 4, 5, 6], "s": [3, 5, 6], "question": [3, 5, 6], "what": [3, 5, 6], "did": [3, 5, 6], "see": [3, 4, 5, 6], "doe": [3, 5, 6], "usual": [3, 4, 5, 6], "similar": [3, 5, 6], "situat": [3, 5, 6], "when": [3, 4, 5, 6], "someth": [3, 5, 6], "chang": [3, 5, 6], "should": [3, 4, 5, 6], "have": [3, 5, 6], "decid": [3, 4, 5, 6], "cross": [3, 4, 5, 6], "instead": [3, 4, 5, 6], "allow": [3, 5], "him": 3, "gain": [3, 5], "insight": [3, 4, 5], "decis": [3, 4, 5, 6], "make": [3, 4, 5, 6], "process": [3, 4, 5, 6], "howev": [3, 5, 6], "abil": 3, "rest": 3, "kei": [3, 4, 5, 6], "assumpt": 3, "set": [3, 4, 5, 6], "traffic": [3, 4, 5, 6], "light": [3, 4, 5, 6], "color": [3, 4, 5], "ambul": [3, 4, 5, 6], "presenc": [3, 4, 5], "must": 3, "contain": [3, 4], "all": [3, 4, 5, 6], "necessari": 3, "inform": [3, 5], "solv": 3, "task": 3, "intersect": [3, 4, 5, 6], "If": [3, 6], "provid": [3, 4, 5], "ar": [3, 4, 5, 6], "perfect": 3, "predict": [3, 4, 6], "enough": 3, "correctli": [3, 4, 5], "becaus": 3, "those": [3, 4], "don": [3, 6], "t": [3, 4, 5, 6], "similarli": [3, 5], "attempt": 3, "encod": [3, 4], "addit": 3, "represent": 3, "thu": [3, 5], "intervent": 3, "unpredict": 3, "lead": [3, 4, 5], "dure": 3, "optim": [3, 4], "between": [3, 4], "two": [3, 4, 5, 6], "conflict": 3, "object": 3, "1": 3, "maxim": 3, "ensur": [3, 5], "accur": [3, 5], "possibl": 3, "2": 3, "specif": 3, "instanc": 3, "occur": 3, "exhibit": 3, "differ": [3, 5, 6], "drop": 3, "perform": 3, "priorit": 3, "perfectli": [3, 6], "downstream": [3, 4], "let": [3, 4], "consid": [3, 5], "an": [3, 4, 5, 6], "exampl": [3, 4, 5], "where": [3, 4, 6], "onli": [3, 5], "access": [3, 4], "could": [3, 4, 5], "first": [3, 4, 6], "case": [3, 4, 5], "without": [3, 4, 6], "would": [3, 5, 6], "base": [3, 4, 6], "sole": 3, "even": [3, 4, 5], "present": [3, 4, 5], "danger": 3, "happen": 3, "about": [3, 6], "avail": 3, "limit": [3, 5], "fulli": 3, "second": [3, 4, 6], "mai": 3, "try": [3, 6], "indirectli": 3, "within": 3, "phenomenon": 3, "known": [3, 4, 5], "leakag": 3, "mix": 3, "As": [3, 4, 6], "result": [3, 4], "interven": [3, 5], "valu": [3, 5, 6], "red": 3, "green": [3, 4, 5, 6], "unintention": 3, "alter": 3, "well": [3, 5, 6], "difficult": 3, "behavior": [3, 4], "after": [3, 5], "now": [3, 5, 6], "entangl": 3, "ultim": 3, "undermin": 3, "interpret": [3, 4, 5, 6], "teenag": [4, 6], "deep": [4, 5], "critic": 4, "gap": 4, "tradit": 4, "dl": 4, "human": [4, 5], "like": [4, 5, 6], "approach": [4, 5, 6], "while": [4, 5], "both": [4, 6], "driver": [4, 5, 6], "stop": [4, 5, 6], "she": [4, 6], "arriv": 4, "conclus": 4, "contrast": 4, "despit": [4, 6], "correct": [4, 5, 6], "lack": 4, "satisfi": [4, 6], "were": [4, 5], "raw": 4, "pixel": [4, 5, 6], "activ": [4, 5, 6], "highlight": 4, "need": [4, 5, 6], "develop": 4, "transpar": 4, "especi": 4, "high": [4, 5], "stake": 4, "field": 4, "medicin": 4, "whether": [4, 5], "give": [4, 6], "certain": 4, "treatment": [4, 5], "financ": 4, "loan": 4, "law": 4, "check": [4, 6], "hire": 4, "system": [4, 6], "fair": 4, "technic": [4, 5, 6], "standpoint": 4, "problem": [4, 5], "describ": 4, "follow": 4, "aim": [4, 6], "relationship": [4, 5], "input": [4, 5, 6], "variabl": 4, "x_i": 4, "mathcal": [4, 5], "x": [4, 5], "imag": [4, 6], "road": [4, 5], "output": 4, "correspond": 4, "y_i": 4, "y": [4, 5], "p": [4, 5], "text": [4, 5], "mid": [4, 5], "directli": [4, 5], "map": 4, "data": [4, 5], "same": 4, "higher": 4, "level": 4, "refer": 4, "more": [4, 6], "her": [4, 6], "reason": [4, 5, 6], "express": 4, "c_1": 4, "c_2": 4, "c_i": [4, 5], "c": [4, 5], "made": [4, 6], "particular": [4, 5], "One": [4, 5], "most": 4, "common": 4, "method": 4, "mimic": 4, "factor": 4, "joint": 4, "probabl": 4, "cdot": 4, "formul": 4, "featur": 4, "them": 4, "These": 4, "analog": 4, "element": 4, "identifi": [4, 5, 6], "class": 4, "parametr": 4, "condit": 4, "distribut": 4, "pair": 4, "neural": 4, "typic": 4, "independ": 4, "bernoulli": 4, "predictor": 4, "f": [4, 5], "categor": 4, "paramet": 4, "theta": 4, "theta_f": [4, 5], "via": 4, "gradient": 4, "descent": 4, "theta_g": [4, 5], "introduc": [4, 5], "you": [4, 6], "implement": 4, "show": 4, "queri": [4, 6], "understand": [4, 5, 6], "simpl": [4, 5], "scenario": [4, 5], "depend": [4, 5], "being": [4, 5], "go": [4, 6], "through": [4, 6], "defin": [4, 5, 6], "import": [4, 6], "torch": 4, "torch_concept": 4, "nn": 4, "conceptencod": 4, "trafficlight": 4, "emb_siz": 4, "5": 4, "n_epoch": 4, "1000": 4, "n_sampl": 4, "dataset": 4, "x_train": 4, "c_train": 4, "y_train": 4, "concept_nam": 4, "task_nam": 4, "sequenti": 4, "linear": 4, "shape": 4, "leakyrelu": 4, "c_scorer": 4, "in_featur": 4, "out_concept_dimens": 4, "y_predictor": 4, "adamw": 4, "lr": 4, "0": [4, 5], "01": 4, "loss_form": 4, "bceloss": 4, "epoch": 4, "rang": 4, "zero_grad": 4, "emb": 4, "c_pred": 4, "sigmoid": 4, "y_pred": 4, "loss": [4, 6], "backward": 4, "100": 4, "print": 4, "item": 4, "2f": 4, "16": 4, "52": 4, "200": 4, "38": 4, "300": 4, "22": 4, "400": 4, "11": 4, "500": 4, "07": 4, "600": 4, "06": 4, "700": 4, "05": 4, "800": 4, "04": 4, "900": 4, "03": 4, "car": [4, 5, 6], "sampl": [4, 5], "eval": 4, "concepttensor": 4, "c_test": 4, "floattensor": 4, "true": [4, 5], "fals": 4, "though": 4, "analyz": 4, "across": [4, 6], "focus": [4, 5, 6], "isn": 4, "c_train_no_ambul": 4, "c_train_ambul": 4, "y_pred_no_ambul": 4, "mean": [4, 5, 6], "y_pred_ambul": 4, "c_train_no_ambulance_green": 4, "prob": 4, "4f": 4, "5000": 4, "2646": 4, "0001": 4, "detect": [4, 5], "50": 4, "around": 4, "25": 4, "never": [4, 5], "expect": [4, 5], "modifi": 4, "singl": 4, "c_test_green_no_ambul": 4, "absenc": 4, "blog": 4, "foundat": 4, "work": 4, "design": 4, "just": [4, 6], "basic": [4, 6], "knowledg": 4, "theori": 4, "content": 4, "self": 4, "option": 4, "preliminari": 4, "experienc": 4, "reader": 4, "focu": 4, "10": 4, "topic": 4, "broad": 4, "advanc": 4, "relev": 4, "appli": 4, "techniqu": 4, "real": [4, 5, 6], "world": [4, 5, 6], "each": 4, "includ": 4, "concis": 4, "pen": 4, "paper": 4, "hand": 4, "exercis": 4, "pytorch": 4, "help": [4, 5, 6], "research": 4, "quickli": [4, 6], "exist": 4, "novel": 4, "cover": 4, "introduct": 4, "That": 5, "left": 5, "puzzl": 5, "he": [5, 6], "watch": 5, "yellow": [5, 6], "realiz": 5, "respons": [5, 6], "pure": 5, "rather": [5, 6], "than": [5, 6], "rule": [5, 6], "emerg": [5, 6], "vehicl": [5, 6], "To": [5, 6], "last": 5, "recogn": 5, "had": [5, 6], "qualit": 5, "reassur": [5, 6], "wai": 5, "assess": 5, "respond": 5, "For": 5, "three": 5, "measur": 5, "A": 5, "indic": 5, "classif": 5, "repres": 5, "likelihood": 5, "l": 5, "mathbb": 5, "_": 5, "alon": 5, "doesn": [5, 6], "guarante": 5, "might": 5, "achiev": 5, "reli": 5, "uninterpret": 5, "poorli": 5, "potenti": 5, "miss": 5, "its": 5, "unaffect": 5, "our": 5, "alwai": 5, "impli": 5, "right": [5, 6], "final": [5, 6], "still": 5, "incorrectli": 5, "also": 5, "causal": 5, "quantifi": 5, "individu": 5, "affect": 5, "It": [5, 6], "much": 5, "impact": 5, "ac": 5, "comput": 5, "fix": 5, "b": 5, "i": [5, 6], "setminu": 5, "statu": 5, "absent": 5, "ha": 5, "strong": 5, "influenc": 5, "assum": 5, "feasibl": 5, "meaning": 5, "easili": 5, "immedi": 5, "manipul": 5, "everi": 5, "context": 5, "person": [5, 6], "attribut": 5, "gender": 5, "direct": 5, "some": 5, "mediat": 5, "anoth": [5, 6], "visibl": 5, "alert": 5, "outcom": 5, "here": 5, "which": 5, "turn": [5, 6], "caus": 5, "indirect": 5, "given": 5, "toggl": 5, "expert": [5, 6], "interact": 5, "improv": 5, "mispredict": 5, "q": 5, "imagin": 5, "wrong": 5, "one": [5, 6], "revis": 5, "recommend": 5, "particularli": [5, 6], "adjust": 5, "highli": 5, "qualiti": 5, "chosen": [5, 6], "reduc": 5, "themselv": 5, "dai": 6, "veri": 6, "up": 6, "job": 6, "determin": 6, "thei": 6, "re": 6, "readi": 6, "licens": 6, "candid": 6, "sarah": 6, "18": 6, "littl": 6, "nervou": 6, "massiv": 6, "transform": 6, "architectur": 6, "train": 6, "action": 6, "brake": 6, "acceler": 6, "live": 6, "hd": 6, "camera": 6, "take": 6, "out": 6, "pre": 6, "circuit": 6, "ll": 6, "handl": 6, "maneuv": 6, "But": 6, "interest": 6, "tricki": 6, "catch": 6, "speed": 6, "other": 6, "lane": 6, "ride": 6, "shift": 6, "cut": 6, "react": 6, "eas": 6, "pleas": 6, "cautiou": 6, "call": 6, "next": 6, "get": 6, "control": 6, "connect": 6, "scene": 6, "time": 6, "too": 6, "smoothli": 6, "pass": 6, "seemingli": 6, "feel": 6, "sens": 6, "relief": 6, "stickler": 6, "detail": 6, "wa": 6, "move": 6, "luck": 6, "find": 6, "post": 6, "reveal": 6, "thought": 6, "start": 6, "saw": 6, "confid": 6, "point": 6, "dig": 6, "deeper": 6, "And": 6, "laugh": 6, "softli": 6, "realli": 6, "matter": 6, "spot": 6, "tension": 6, "proce": 6, "ahead": 6, "hadn": 6, "ve": 6, "sai": 6, "hesit": 6, "clear": 6, "grant": 6, "clearli": 6, "understood": 6, "ai": 6, "friend": 6, "tap": 6, "exact": 6, "incred": 6, "captur": 6, "everyth": 6, "down": 6, "fur": 6, "nearbi": 6, "dog": 6, "vagu": 6, "yet": 6, "know": 6, "why": 6, "so": 6, "press": 6, "type": 6, "embed": 6, "block": 6, "42": 6, "abov": 6, "173": 6, "frown": 6, "confus": 6, "explan": 6, "disconnect": 6, "hear": 6, "hope": 6, "clariti": 6, "again": 6, "number": 6, "2890": 6, "origin": 6, "rgb": 6, "28": 6, "178": 6, "111": 6, "ti": 6, "ye": 6, "truli": 6, "Or": 6, "act": 6, "pattern": 6, "seen": 6, "befor": 6, "sit": 6, "contempl": 6, "linger": 6, "mind": 6}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"concept": [0, 2, 3, 4, 5, 7], "base": [0, 2, 5, 7], "interpret": [0, 2], "deep": [0, 2, 6], "learn": [0, 2, 6], "python": [0, 2], "contribut": 0, "bibliographi": 1, "introduct": 2, "neural": [2, 8], "reason": [2, 7], "refer": 2, "The": [3, 6, 8], "accuraci": 3, "explain": 3, "trade": 3, "off": 3, "consequ": 3, "incomplet": 3, "bottleneck": 4, "model": [4, 5, 6], "code": [4, 5], "practic": [4, 5], "step": 4, "1": [4, 5], "definit": 4, "train": 4, "2": [4, 5], "observ": 4, "task": [4, 5], "relat": 4, "3": [4, 5], "averag": [4, 5], "effect": [4, 5], "4": 4, "chang": 4, "s": 4, "valu": 4, "seri": 4, "overview": 4, "quantit": 5, "metric": 5, "predict": 5, "perform": 5, "intervent": 5, "tale": 6, "fail": 6, "my": 6, "drive": 6, "exam": 6, "memori": 7, "gener": 8, "symbol": 8, "execut": 8, "paradigm": 8}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinxcontrib.bibtex": 9, "sphinx": 56}})